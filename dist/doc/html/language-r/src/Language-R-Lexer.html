<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://www.cs.york.ac.uk/fp/darcs/hscolour/ -->
<title>src/Language/R/Lexer.hs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="line-1"></a><span class='hs-comment'>{-# LANGUAGE FlexibleInstances, TypeSynonymInstances, FlexibleContexts, CPP, DeriveDataTypeable #-}</span>
<a name="line-2"></a><span class='hs-comment'>-----------------------------------------------------------------------------</span>
<a name="line-3"></a><span class='hs-comment'>-- |</span>
<a name="line-4"></a><span class='hs-comment'>-- Module      : Language.R.Lexer</span>
<a name="line-5"></a><span class='hs-comment'>-- Copyright   : (c) 2010 David M. Rosenberg</span>
<a name="line-6"></a><span class='hs-comment'>-- License     : BSD3</span>
<a name="line-7"></a><span class='hs-comment'>-- </span>
<a name="line-8"></a><span class='hs-comment'>-- Maintainer  : David Rosenberg &lt;rosenbergdm@uchicago.edu&gt;</span>
<a name="line-9"></a><span class='hs-comment'>-- Stability   : experimental</span>
<a name="line-10"></a><span class='hs-comment'>-- Portability : portable</span>
<a name="line-11"></a><span class='hs-comment'>-- Created     : 05/28/10</span>
<a name="line-12"></a><span class='hs-comment'>-- </span>
<a name="line-13"></a><span class='hs-comment'>-- Description :</span>
<a name="line-14"></a><span class='hs-comment'>--    This module contains the functions used for lexing an list of</span>
<a name="line-15"></a><span class='hs-comment'>--    strings (representing either source code lines or interactive</span>
<a name="line-16"></a><span class='hs-comment'>--    input) into a stack of tokens.</span>
<a name="line-17"></a><span class='hs-comment'>-----------------------------------------------------------------------------</span>
<a name="line-18"></a>
<a name="line-19"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>Language</span><span class='hs-varop'>.</span><span class='hs-conid'>R</span><span class='hs-varop'>.</span><span class='hs-conid'>Lexer</span> <span class='hs-keyword'>where</span>
<a name="line-20"></a>
<a name="line-21"></a>
<a name="line-22"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Language</span><span class='hs-varop'>.</span><span class='hs-conid'>R</span><span class='hs-varop'>.</span><span class='hs-conid'>SrcLocation</span>
<a name="line-23"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Language</span><span class='hs-varop'>.</span><span class='hs-conid'>R</span><span class='hs-varop'>.</span><span class='hs-conid'>Token</span>
<a name="line-24"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Language</span><span class='hs-varop'>.</span><span class='hs-conid'>R</span><span class='hs-varop'>.</span><span class='hs-conid'>AST</span>
<a name="line-25"></a>
<a name="line-26"></a>
<a name="line-27"></a><span class='hs-comment'>{- 
<a name="line-28"></a>retokenize :: [Token] -&gt; [Token] -&gt; Maybe [Token]
<a name="line-29"></a>retokenize [] outToks     = outToks
<a name="line-30"></a>retokenize inToks outToks =
<a name="line-31"></a>   let slurp     = takeWhile (\z -&gt; tryBuildSyntaxNode z == []) inToks'
<a name="line-32"></a>       inToks'   = drop (length slurp) inToks'
<a name="line-33"></a>       newSyntax = buildSyntaxNode slurp
<a name="line-34"></a>       outToks'  = concat [[newSyntax], outToks]
<a name="line-35"></a>   in retokenize inToks' outToks'
<a name="line-36"></a>  
<a name="line-37"></a>
<a name="line-38"></a>data IdentStatus = IdReserved 
<a name="line-39"></a>                 | IdBuiltin
<a name="line-40"></a>                 | IdDefined
<a name="line-41"></a>                 | IdUndefined
<a name="line-42"></a>
<a name="line-43"></a>
<a name="line-44"></a>classifyIdent tk
<a name="line-45"></a>  | tk `elem` (map fst rFuncPrims) = IdReserved 
<a name="line-46"></a>  | tk `elem` rBuiltins            = IdBuiltin
<a name="line-47"></a>  | tk `elem` (map fst rNameTable) = IdDefined
<a name="line-48"></a>  | otherwise                      = IdUndefined
<a name="line-49"></a>
<a name="line-50"></a>-- | Production rules
<a name="line-51"></a>-- buildStmtExpr 
<a name="line-52"></a>
<a name="line-53"></a>
<a name="line-54"></a>
<a name="line-55"></a>
<a name="line-56"></a>
<a name="line-57"></a>
<a name="line-58"></a>
<a name="line-59"></a>
<a name="line-60"></a>
<a name="line-61"></a>
<a name="line-62"></a>
<a name="line-63"></a>
<a name="line-64"></a>
<a name="line-65"></a>
<a name="line-66"></a>
<a name="line-67"></a>rBuiltins = 
<a name="line-68"></a> [ "zeroin2", "zeroin", "xzfile", "xspline", "X11", "wsbrowser" "writeLines"
<a name="line-69"></a> , "writeChar", "writeBin", "write.table", "withVisible", "which.min"
<a name="line-70"></a> , "which.max", "warning", "Version", "vector", "utf8ToInt", "url"
<a name="line-71"></a> , "update.formula", "unzip", "unz", "unserializeFromConn"
<a name="line-72"></a> , "unregisterNamespace", "unlockBinding", "unlist", "unlink", "unique"
<a name="line-73"></a> , "undebug", "typeof", "type.convert", "truncate", "toupper", "tolower"
<a name="line-74"></a> , "title", "textConnectionValue", "textConnection", "text", "terms.formula"
<a name="line-75"></a> , "tempfile", "tempdir", "tcrossprod", "t.default", "system", "Sys.unsetenv"
<a name="line-76"></a> , "Sys.umask", "Sys.time", "Sys.sleep", "Sys.setlocale", "Sys.setenv"
<a name="line-77"></a> , "Sys.readlink", "sys.parents", "sys.parent", "sys.on.exit", "sys.nframe"
<a name="line-78"></a> , "Sys.localeconv", "Sys.info", "Sys.glob", "Sys.getpid", "Sys.getlocale"
<a name="line-79"></a> , "Sys.getenv", "sys.function", "sys.frames", "sys.frame", "Sys.chmod"
<a name="line-80"></a> , "sys.calls", "sys.call", "symbols", "switch", "summary.connection"
<a name="line-81"></a> , "substr&lt;-", "substr", "sub", "strwidth", "strtrim", "strsplit", "strptime"
<a name="line-82"></a> , "strheight", "stopHTTPD", "stop", "stdout", "stdin", "stderr", "startHTTPD"
<a name="line-83"></a> , "sprintf", "split", "sort", "sockSelect", "socketConnection", "sink.number"
<a name="line-84"></a> , "sink", "setwd", "setToCConverterActiveStatus", "setTimeLimit"
<a name="line-85"></a> , "setSessionTimeLimit", "seterrmessage", "setEncoding", "set.seed"
<a name="line-86"></a> , "serializeToConn", "select.list", "segments", "seek", "search", "scan"
<a name="line-87"></a> , "saveToConn", "savePlot", "savehistory", "save.to.file", "save", "sample"
<a name="line-88"></a> , "rwilcox", "rweibull", "runif", "rt", "rsignrank", "Rprofmem", "Rprof"
<a name="line-89"></a> , "rpois", "rowSums", "rowMeans", "row", "rnorm", "RNGkind", "rnchisq"
<a name="line-90"></a> , "rnbinom_mu", "rnbinom", "rmultinom", "rlogis", "rlnorm", "rhyper", "rgeom"
<a name="line-91"></a> , "rgb2hsv", "rgb256", "rgb", "rgamma", "rf", "rexp", "restart", "rep.int"
<a name="line-92"></a> , "removeToCConverterActiveStatus", "remove", "registerNamespace", "regexpr"
<a name="line-93"></a> , "reg.finalizer", "rect", "recordGraphics", "Recall", "readTableHead"
<a name="line-94"></a> , "readLines", "readline", "readDCF", "readChar", "readBin", "rchisq"
<a name="line-95"></a> , "rcauchy", "rbinom", "rbind", "rbeta", "rawToChar", "rawToBits", "rawShift"
<a name="line-96"></a> , "rawConnectionValue", "rawConnection", "rapply", "rank", "radixsort"
<a name="line-97"></a> , "R.home", "qwilcox", "qweibull", "qunif", "quit", "qtukey", "qt", "qsort"
<a name="line-98"></a> , "qsignrank", "qpois", "qnt", "qnorm", "qnf", "qnchisq", "qnbinom_mu"
<a name="line-99"></a> , "qnbinom", "qnbeta", "qlogis", "qlnorm", "qhyper", "qgeom", "qgamma", "qf"
<a name="line-100"></a> , "qexp", "qchisq", "qcauchy", "qbinom", "qbeta", "pwilcox", "pweibull"
<a name="line-101"></a> , "putconst", "pushBackLength", "pushBack", "punif", "ptukey", "pt", "psort"
<a name="line-102"></a> , "psignrank", "psigamma", "prmatrix", "printDeferredWarnings"
<a name="line-103"></a> , "print.function", "print.default", "ppois", "POSIXlt2Date", "polyroot"
<a name="line-104"></a> , "polygon", "pnt", "pnorm", "pnf", "pnchisq", "pnbinom_mu", "pnbinom"
<a name="line-105"></a> , "pnbeta", "pmin", "pmax", "pmatch", "plot.xy", "plot.window", "plot.new"
<a name="line-106"></a> , "plogis", "plnorm", "playSnapshot", "pkgbrowser", "pipe", "phyper", "pgeom"
<a name="line-107"></a> , "pgamma", "pf", "pexp", "persp", "pchisq", "pcauchy", "pbinom", "pbeta"
<a name="line-108"></a> , "path.expand", "paste", "parse_Rd", "parse", "parent.frame", "parent.env&lt;-"
<a name="line-109"></a> , "parent.env", "par", "palette", "packBits", "package.manager", "order"
<a name="line-110"></a> , "options", "optimhess", "optim", "open", "object.size", "nsl"
<a name="line-111"></a> , "normalizePath", "nlm", "ngettext", "nextn", "NextMethod", "new.env", "nchar"
<a name="line-112"></a> , "mvfft", "mtext", "model.matrix", "model.frame", "mkUnbound", "mkCode"
<a name="line-113"></a> , "mget", "merge", "menu", "memory.profile", "memDecompress", "memCompress"
<a name="line-114"></a> , "mem.limits", "mean", "matrix", "match.call", "match", "makeLazy"
<a name="line-115"></a> , "makeActiveBinding", "make.unique", "make.names", "machine", "ls"
<a name="line-116"></a> , "lockEnvironment", "lockBinding", "locator", "loadhistory", "loadFromConn2"
<a name="line-117"></a> , "load.from.file", "load", "list.files", "lib.fixup", "lchoose", "lbeta"
<a name="line-118"></a> , "layout", "lapply", "l10n_info", "isSeekable", "isOpen", "isNamespaceEnv"
<a name="line-119"></a> , "islistfactor", "isIncomplete", "isdebugged", "is.vector", "is.unsorted"
<a name="line-120"></a> , "is.loaded", "is.builtin.internal", "intToUtf8", "intToBits"
<a name="line-121"></a> , "interruptsSuspended", "inspect", "inherits", "index.search", "importIntoEnv"
<a name="line-122"></a> , "image", "identify", "identical", "icuSetCollate", "iconv", "hsv"
<a name="line-123"></a> , "hsbrowser", "hcl", "gzfile", "gzcon", "gsub", "grepl", "grep", "gregexpr"
<a name="line-124"></a> , "grconvertY", "grconvertX", "gray", "getwd", "gettext", "getSnapshot"
<a name="line-125"></a> , "getRtoCConverterStatus", "getRtoCConverterDescriptions"
<a name="line-126"></a> , "getRegisteredNamespace", "getNumRtoCConverters", "getNamespaceRegistry"
<a name="line-127"></a> , "getGraphicsEvent", "geterrmessage", "getConnection", "getAllConnections"
<a name="line-128"></a> , "get", "gctorture", "gcinfo", "gc", "format.POSIXlt", "format.info", "format"
<a name="line-129"></a> , "formals", "fmin", "flush.console", "flush", "filledcontour", "file.symlink"
<a name="line-130"></a> , "file.show", "file.rename", "file.remove", "file.path", "file.info"
<a name="line-131"></a> , "file.exists", "file.edit", "file.create", "file.copy", "file.choose"
<a name="line-132"></a> , "file.append", "file.access", "file", "fifo", "fft", "exists"
<a name="line-133"></a> , "eval.with.vis", "eval", "erase", "environmentName", "environmentIsLocked"
<a name="line-134"></a> , "environment", "env2list", "env.profile", "Encoding", "encodeString", "edit"
<a name="line-135"></a> , "eapply", "dyn.unload", "dyn.load", "dwilcox", "dweibull", "duplicated"
<a name="line-136"></a> , "dunif", "dump", "dtukey", "dt", "dsignrank", "drop", "dput", "dpois"
<a name="line-137"></a> , "download", "do.call", "dnt", "dnorm", "dnf", "dnchisq", "dnbinom_mu"
<a name="line-138"></a> , "dnbinom", "dnbeta", "dlogis", "dlnorm", "disassemble", "dirname", "dirchmod"
<a name="line-139"></a> , "dir.create", "dhyper", "dgeom", "dgamma", "df", "dexp", "devAskNewPage"
<a name="line-140"></a> , "dev.size", "dev.set", "dev.prev", "dev.off", "dev.next", "dev.displaylist"
<a name="line-141"></a> , "dev.cur", "dev.copy", "dev.control", "detach", "deriv.default", "deparseRd"
<a name="line-142"></a> , "deparse", "dend.window", "dend", "delayedAssign", "debugonce", "debug"
<a name="line-143"></a> , "dchisq", "dcauchy", "dbinom", "dbeta", "Date2POSIXlt", "date", "dataviewer"
<a name="line-144"></a> , "dataentry", "data.manager", "D", "Cstack_info", "crossprod", "cov"
<a name="line-145"></a> , "count.fields", "cor", "contourLines", "contour", "complex", "complete.cases"
<a name="line-146"></a> , "comment&lt;-", "comment", "commandArgs", "colSums", "colors", "colMeans"
<a name="line-147"></a> , "col2rgb", "col", "codeFiles.append", "close", "clip", "clearPushBack"
<a name="line-148"></a> , "choose", "chartr", "charToRaw", "charmatch", "cbind", "cat"
<a name="line-149"></a> , "capabilitiesX11", "capabilities", "cairo", "bzfile", "builtins"
<a name="line-150"></a> , "browserText", "browserSetDebug", "browserCondition", "box", "bodyCode"
<a name="line-151"></a> , "body", "bindtextdomain", "bindingIsLocked", "bindingIsActive", "beta"
<a name="line-152"></a> , "besselY", "besselK", "besselJ", "besselI", "bcVersion", "bcClose"
<a name="line-153"></a> , "basename", "axis", "attach", "atan2", "assign", "as.vector", "as.POSIXlt"
<a name="line-154"></a> , "as.POSIXct", "as.function.default", "arrows", "args", "aqua.custom.print"
<a name="line-155"></a> , "aperm", "anyDuplicated", "all.names", "agrep", "addhistory", "abline"
<a name="line-156"></a> , "abbreviate", ".signalCondition", ".resetCondHands", ".invokeRestart"
<a name="line-157"></a> , ".getRestart", ".dfltWarn", ".dfltStop", ".addTryHandlers", ".addRestart"
<a name="line-158"></a> , ".addCondHands" 
<a name="line-159"></a> ]
<a name="line-160"></a>-}</span>
</pre></body>
</html>
